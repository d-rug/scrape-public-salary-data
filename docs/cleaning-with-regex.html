<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Cleaning with regex | Scrape public [salary] data</title>
  <meta name="description" content="4 Cleaning with regex | Scrape public [salary] data" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Cleaning with regex | Scrape public [salary] data" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="d-rug/scrape-public-salary-data" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Cleaning with regex | Scrape public [salary] data" />
  
  
  

<meta name="author" content="Liza Wood" />


<meta name="date" content="2022-11-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="scraping-structured-data-iteravely.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.22/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://d-rug.github.io/">
  <img src="https://github.com/d-rug/d-rug.github.io/raw/main/DRUG_final_cobalt.png" style="height: 100%; width: 100%; object-fit: contain" />
</a></li>
<li><a href="./" style="font-size: 18px">Scrape public [salary] data</a></li>

<li class="divider"></li>
<li><a href="index.html#overview" id="toc-overview">Overview<span></span></a></li>
<li><a href="scraping-unstructured-data.html#scraping-unstructured-data" id="toc-scraping-unstructured-data"><span class="toc-section-number">1</span> Scraping unstructured data<span></span></a>
<ul>
<li><a href="scraping-unstructured-data.html#reading-in-a-webpage" id="toc-reading-in-a-webpage"><span class="toc-section-number">1.1</span> Reading in a webpage<span></span></a></li>
<li><a href="scraping-unstructured-data.html#identifying-xpaths" id="toc-identifying-xpaths"><span class="toc-section-number">1.2</span> Identifying xpaths<span></span></a></li>
</ul></li>
<li><a href="formatting-unstructured-data.html#formatting-unstructured-data" id="toc-formatting-unstructured-data"><span class="toc-section-number">2</span> Formatting unstructured data<span></span></a>
<ul>
<li><a href="formatting-unstructured-data.html#what-format-do-we-need-the-data-in" id="toc-what-format-do-we-need-the-data-in"><span class="toc-section-number">2.1</span> What format do we need the data in?<span></span></a></li>
</ul></li>
<li><a href="scraping-structured-data-iteravely.html#scraping-structured-data-iteravely" id="toc-scraping-structured-data-iteravely"><span class="toc-section-number">3</span> Scraping structured data iteravely<span></span></a>
<ul>
<li><a href="scraping-structured-data-iteravely.html#scrape-one-example" id="toc-scrape-one-example"><span class="toc-section-number">3.1</span> Scrape one example<span></span></a></li>
<li><a href="scraping-structured-data-iteravely.html#iterating-scrape-across-urls" id="toc-iterating-scrape-across-urls"><span class="toc-section-number">3.2</span> Iterating scrape across URLs<span></span></a></li>
</ul></li>
<li><a href="cleaning-with-regex.html#cleaning-with-regex" id="toc-cleaning-with-regex"><span class="toc-section-number">4</span> Cleaning with regex<span></span></a>
<ul>
<li><a href="cleaning-with-regex.html#filter-on-multiple-patterns" id="toc-filter-on-multiple-patterns"><span class="toc-section-number">4.1</span> Filter on multiple patterns<span></span></a></li>
<li><a href="cleaning-with-regex.html#remove-characters" id="toc-remove-characters"><span class="toc-section-number">4.2</span> Remove characters<span></span></a></li>
</ul></li>
<li class="divider"></li>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
  <img alt="CC BY-SA 4.0" src="https://img.shields.io/badge/License-CC%20BY--NC--SA%204.0-lightgrey.svg" style="float: right; padding-right: 10px;" />
</a>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Scrape public [salary] data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cleaning-with-regex" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Cleaning with regex<a href="cleaning-with-regex.html#cleaning-with-regex" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Whenever we’re working with text, from the internet or otherwise, there is going to be some string manipulation that can help us clean and work with the data. To work with text data it is important to have a sense of regular expressions, or regex. My favorite quick resource is the second page of the <a href="https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf">stringr cheat sheet</a>.</p>
<p>Regex is a pattern language that is used for text that can help</p>
<div id="filter-on-multiple-patterns" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Filter on multiple patterns<a href="cleaning-with-regex.html#filter-on-multiple-patterns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="cleaning-with-regex.html#cb19-1" aria-hidden="true" tabindex="-1"></a>salary.df <span class="ot">&lt;-</span> salary.df <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="cleaning-with-regex.html#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Overtime.pay, Benefits, Total.pay...benefits)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="cleaning-with-regex.html#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">str_detect</span>(Job.title, <span class="st">&quot;Prof|Specialist&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="cleaning-with-regex.html#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">str_detect</span>(Job.title, <span class="st">&quot;Adj&quot;</span>))) </span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="cleaning-with-regex.html#cb20-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(salary.df, <span class="at">rownames =</span> F)</span></code></pre></div>
<div id="htmlwidget-9bb029e8f7c1078335ab" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9bb029e8f7c1078335ab">{"x":{"filter":"none","vertical":false,"data":[["Jesus Barajas","Marissa Baskett","Xiaoli Dong","Edwin Grosholz","Susan Handy","Susan Harrison","Robert Hijmans","Marcel Holyoak","John Largier","Mark Lubell","Frances Moore","Steven Morgan","Steven Sadro","James Sanchirico","Mark Schwartz","Tyler Scott","Michael Springborn","Thomas Tomich","Fernanda Valdovinos"],["Asst Prof-AyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Asst Prof-AyUniversity of California, 2021","Specialist Coop ExtUniversity of California, 2021","Prof-FyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Prof-AyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Asst Prof-AyUniversity of California, 2021","Prof-AyUniversity of California, 2021","Assoc Prof-AyUniversity of California, 2021","Prof-Fy-B/E/EUniversity of California, 2021","Prof-FyUniversity of California, 2021","Assoc Prof-AyUniversity of California, 2021","Assoc Prof-FyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Asst Prof-AyUniversity of California, 2021"],["$93,367.00","$142,200.00","$99,000.00","$196,971.00","$225,192.00","$241,100.00","$161,300.00","$190,450.00","$199,438.00","$198,883.00","$108,233.00","$158,000.00","$103,783.00","$220,400.00","$155,000.00","$117,650.00","$160,500.00","$254,767.00","$97,500.00"],["$3,252.00","$21,344.00","$8,208.00","$9,136.00","$21,673.00","$10,000.00","$0.00","$30,000.00","$68,517.00","$18,491.00","$17,950.00","$10,533.00","$33,811.00","$19,936.00","$24,052.00","$36,047.00","$14,518.00","$0.00","$10,778.00"],["$96,619.00","$163,544.00","$107,208.00","$206,107.00","$246,865.00","$251,100.00","$161,300.00","$220,450.00","$267,955.00","$217,374.00","$126,183.00","$168,533.00","$137,594.00","$240,336.00","$179,052.00","$153,697.00","$175,018.00","$254,767.00","$108,278.00"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Name<\/th>\n      <th>Job.title<\/th>\n      <th>Regular.pay<\/th>\n      <th>Other.pay<\/th>\n      <th>Total.pay<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="remove-characters" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Remove characters<a href="cleaning-with-regex.html#remove-characters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For working with the data, however, we want to remove symbols like dollar signs and commas. We can use regular expressions to remove the special characters, but it is important to note that some symbols we use for punctuation have special meanins in regex. For example:<br />
* . = every character
* $ = end of a string
* ^ = end of a string
* + = one or more characters</p>
<p>When you want to use a symbol in a pattern and use the <em>actual symbol</em>, rather than its special meaning, you need to ‘escape’ the character to signify to the regular expression that you really mean a period (.) rather than every character. So here we can remove dollar signs and commas, but make sure we escape the sign the two backlashes in R.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="cleaning-with-regex.html#cb21-1" aria-hidden="true" tabindex="-1"></a>salary.df <span class="ot">&lt;-</span> salary.df <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="cleaning-with-regex.html#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Regular.pay =</span> <span class="fu">as.numeric</span>(<span class="fu">str_remove_all</span>(Regular.pay,  <span class="st">&quot;</span><span class="sc">\\</span><span class="st">$|,&quot;</span>)),</span>
<span id="cb21-3"><a href="cleaning-with-regex.html#cb21-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Total.pay =</span> <span class="fu">as.numeric</span>(<span class="fu">str_remove_all</span>(Total.pay, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">$|,&quot;</span>))) </span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="cleaning-with-regex.html#cb22-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(salary.df, <span class="at">rownames =</span> F)</span></code></pre></div>
<div id="htmlwidget-27f41e1136e13f99ada6" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-27f41e1136e13f99ada6">{"x":{"filter":"none","vertical":false,"data":[["Jesus Barajas","Marissa Baskett","Xiaoli Dong","Edwin Grosholz","Susan Handy","Susan Harrison","Robert Hijmans","Marcel Holyoak","John Largier","Mark Lubell","Frances Moore","Steven Morgan","Steven Sadro","James Sanchirico","Mark Schwartz","Tyler Scott","Michael Springborn","Thomas Tomich","Fernanda Valdovinos"],["Asst Prof-AyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Asst Prof-AyUniversity of California, 2021","Specialist Coop ExtUniversity of California, 2021","Prof-FyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Prof-AyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Asst Prof-AyUniversity of California, 2021","Prof-AyUniversity of California, 2021","Assoc Prof-AyUniversity of California, 2021","Prof-Fy-B/E/EUniversity of California, 2021","Prof-FyUniversity of California, 2021","Assoc Prof-AyUniversity of California, 2021","Assoc Prof-FyUniversity of California, 2021","Prof-FyUniversity of California, 2021","Asst Prof-AyUniversity of California, 2021"],[93367,142200,99000,196971,225192,241100,161300,190450,199438,198883,108233,158000,103783,220400,155000,117650,160500,254767,97500],["$3,252.00","$21,344.00","$8,208.00","$9,136.00","$21,673.00","$10,000.00","$0.00","$30,000.00","$68,517.00","$18,491.00","$17,950.00","$10,533.00","$33,811.00","$19,936.00","$24,052.00","$36,047.00","$14,518.00","$0.00","$10,778.00"],[96619,163544,107208,206107,246865,251100,161300,220450,267955,217374,126183,168533,137594,240336,179052,153697,175018,254767,108278]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Name<\/th>\n      <th>Job.title<\/th>\n      <th>Regular.pay<\/th>\n      <th>Other.pay<\/th>\n      <th>Total.pay<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,4]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="scraping-structured-data-iteravely.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/d-rug/scrape-public-salary-data/edit/master/01_scraping-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/d-rug/scrape-public-salary-data/blob/master/01_scraping-data.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
